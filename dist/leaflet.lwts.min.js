L.Control.SliderControl=L.Control.extend({options:{position:"topright",layers:null,startTime:moment(0),endTime:moment(0),timeStep:3600,timeStepValues:[],range:!1,dateDisplayFormat:"YYYY-MM-DDTHH:mm:ssZ"},initialize:function(a){if(L.Util.setOptions(this,a),this._layer=null,this.multilayer=!1,a.startTime&&(this._begin_time=moment(a.startTime)),a.startTime&&(this._final_time=moment(a.endTime)),a.timeStep&&(this.options.timeStep=1e3*this.options.timeStep),!a.timeStepValues||0===a.timeStepValues.length)for(var b=Math.round((this._final_time-this._begin_time)/this.options.timeStep),c=0;b>c;++c)this.options.timeStepValues.push(moment(this._begin_time).add(c*this.options.timeStep,"ms"));null==this.options.layers?(this._layer=this.options.layer,this.multilayer=!1):(this._layer=this.options.layers,this.multilayer=!0)},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this.startSlider(),this},createSliderUI:function(){var a=L.DomUtil.create("div","ui-slider-container",this._container);return this._slider=$('<div class="ui-slider"><div class="ui-slider-handle"></div></div>'),$(a).append(this._slider),this._sliderTimestamp=$('<div class="ui-slider-timestamp"></div>'),$(a).append(this._sliderTimestamp),a},onAdd:function(a){this.options.map=a;var b=this.createSliderUI();return $(b).mousedown(function(){a.dragging.disable()}),$(document).mouseup(function(){a.dragging.enable()}),this._layer||console.log("Error: You must specify a layer via new SliderControl({layer: your_layer}); or like SliderControl({layers: [your_layer1, your_layer2]});"),b},onRemove:function(a){a.removeLayer(this._layer),$(this._slider).remove()},updateLayer:function(a){if(1===a.length?timestamp=a[0].format():timestamp=a[0].format()+"/"+a[1].format(),1==this.multilayer)for(var b=0;b<this._layer.length;b++)this._layer[b].setParams({time:timestamp});else this._layer.setParams({time:timestamp})},updateTimestamp:function(a){1===a.length?$(this._sliderTimestamp).html(a[0].format(this.options.dateDisplayFormat)):$(this._sliderTimestamp).html("Range: "+a[0].format(this.options.dateDisplayFormat)+" - "+a[1].format(this.options.dateDisplayFormat))},buildTimestamp:function(a,b){var c=[];return c.push(this.options.timeStepValues[a]),b&&c.push(this.options.timeStepValues[b]),c},startSlider:function(){var a=this;$(a._slider).slider({range:a.options.range,min:0,max:a.options.timeStepValues.length,step:1,slide:function(b,c){a.options.range?a.updateTimestamp(a.buildTimestamp(c.values[0],c.values[1])):a.updateTimestamp(a.buildTimestamp(c.value))},stop:function(b,c){a.options.range?a.updateLayer(a.buildTimestamp(c.values[0],c.values[1])):a.updateLayer(a.buildTimestamp(c.value))}}),a.options.range?(a.updateTimestamp(a.buildTimestamp(0,1)),a.updateLayer(a.buildTimestamp(0,1))):(a.updateTimestamp(a.buildTimestamp(0)),a.updateLayer(a.buildTimestamp(0)))}}),L.control.sliderControl=function(a){return new L.Control.SliderControl(a)};